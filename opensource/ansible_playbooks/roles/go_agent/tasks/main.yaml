- name: Gather information about Go CD Server 
  community.aws.ec2_instance_info:
    filters:
      tag:Name: GoServer
  register: go_server_info
- name: Install Java 11
  apt:
    name: openjdk-11-jre-headless
    state: present
  become: yes
- name: Install GO CD Agent
  apt:
    name: go-agent
    state: present
  become: yes
- name: Ensure GO CD Agent Service is running
  ansible.builtin.systemd:
    state: restarted
    name: go-agent
  become: yes
- name: Test to see if we can use go cd server information
  ansible.builtin.file:
    path: ~/{{go_server_info.instances[0].network_interfaces[0].public_ip}}.txt
    state: touch